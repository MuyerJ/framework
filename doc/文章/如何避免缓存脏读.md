[link](https://zhuanlan.zhihu.com/p/388488860)

### 问题：假设某个数据缓存在Redis中，当我在后台更新了数据后，如何保证客户端读取的是最新的数据呢？

#### 1、redis的脏读
```
假设redis设置了缓存失效时间（比如1小时），那么在这一小时内，如果有人更新了DB的数据，只要缓存不失效，Redis就不会主动读取DB并更新数据，那么用户看到的其实都是旧的数据，与DB不一致，此谓缓存脏读。
```

解决
```
找到更新数据的入口，每次更新DB都同步或异步更新缓存

public void update(){
  1.更新数据库
  2.更新缓存（同步或异步）
}


===> 如果A线程刚更新完缓存，B线程又来更新数据库，且尚未更新缓存，此时C线程从缓存中读到的就是旧的数据了


public void update(){
  0.更新缓存（同步或异步）
  1.更新数据库
  2.更新缓存（同步或异步）
}

```